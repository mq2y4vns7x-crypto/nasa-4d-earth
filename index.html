<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>NASA_SYSTEM_RECOVERY</title>
    <script src="https://unpkg.com/three"></script>
    <script src="https://unpkg.com/three-globe"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/examples/js/controls/OrbitControls.js"></script>
    <style>
        body { margin: 0; background: #000; overflow: hidden; font-family: 'Courier New', monospace; }
        
        #loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; color: #4af; display: flex; flex-direction: column;
            justify-content: center; align-items: center; z-index: 1000;
        }

        /* High-speed mutating numbers */
        #data-buffer { 
            font-size: 32px; 
            font-weight: bold; 
            letter-spacing: 8px; 
            color: #4af; 
            text-shadow: 0 0 10px rgba(68, 170, 255, 0.7); 
        }

        #status-bar { 
            font-size: 10px; 
            margin-top: 20px; 
            color: #265; /* Dimmer green for sub-text */
            letter-spacing: 2px;
        }

        #progress-line { width: 300px; height: 1px; background: #111; margin-top: 30px; }
        #fill { width: 0%; height: 100%; background: #4af; transition: width 0.05s; }
    </style>
</head>
<body>

    <div id="loader">
        <div id="data-buffer">000000000000</div>
        <div id="status-bar">BITSTREAM_RECOVERY_IN_PROGRESS...</div>
        <div id="progress-line"><div id="fill"></div></div>
    </div>

    <div id="globeViz"></div>

    <script>
        const World = new ThreeGlobe().showAtmosphere(true).atmosphereColor('#4af');
        
        let cycles = 0;
        const max = 100;
        const buffer = document.getElementById('data-buffer');
        const status = document.getElementById('status-bar');
        const bar = document.getElementById('fill');

        // HYPER-LOOP: 100 UPDATES PER SECOND
        const hyperLoop = setInterval(() => {
            cycles++;

            // Update the mutating string
            // It generates 12 random digits every 10ms
            let stream = "";
            for(let i=0; i<12; i++) {
                stream += Math.floor(Math.random() * 10);
            }
            buffer.innerText = stream;
            
            bar.style.width = cycles + '%';

            // ATTEMPT OVERLAYS & COMBINATIONS
            if (cycles === 15) {
                status.innerText = "LAYER_01: INJECTING_GIBS_TILE_SERVICE";
                World.globeTileEngineUrl((x, y, l) => 
                    `https://gibs.earthdata.nasa.gov/wmts/epsg4326/best/BlueMarble_ShadedRelief_Bathymetry/default/500m/${l}/${y}/${x}.jpg`
                );
            }
            
            if (cycles === 45) {
                status.innerText = "LAYER_02: COMBINING_TOPOLOGY_HEIGHT_MAPS";
                World.bumpImageUrl('https://unpkg.com/three-globe/example/img/earth-topology.png');
            }

            if (cycles === 75) {
                status.innerText = "LAYER_03: STITCHING_BLUE_MARBLE_TRUECOLOR";
                World.globeImageUrl('https://unpkg.com/three-globe/example/img/earth-blue-marble.jpg');
            }

            if (cycles >= max) {
                clearInterval(hyperLoop);
                buffer.innerText = "LINK_SECURED";
                status.innerText = "NASA_GIBS_STREAM_STABLE";
                
                setTimeout(() => {
                    document.getElementById('loader').style.opacity = '0';
                    setTimeout(() => document.getElementById('loader').remove(), 500);
                }, 300);
            }
        }, 10); // 10ms = 100Hz

        // 3D Scene Initialization
        const scene = new THREE.Scene();
        scene.add(World);
        scene.add(new THREE.AmbientLight(0xffffff, 1.2));
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.getElementById('globeViz').appendChild(renderer.domElement);
        const camera = new THREE.PerspectiveCamera(45, window.innerWidth/window.innerHeight, 1, 2000);
        camera.position.z = 400;
        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;

        function animate() {
            World.rotation.y += 0.001;
            controls.update();
            renderer.render(scene, camera);
            requestAnimationFrame(animate);
        }
        animate();
    </script>
</body>
</html>
